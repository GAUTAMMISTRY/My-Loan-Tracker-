
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Home Loan Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Swiper -->
<link href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<!-- Excel -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
:root {
  --primary: #4f46e5;
  --secondary: #22c55e;
  --dark: #0f172a;
  --light: #f8fafc;
}
body {
  font-family: 'Inter', sans-serif;
  background: linear-gradient(135deg,#eef2ff,#f8fafc);
  color: var(--dark);
}
.glass {
  background: rgba(255,255,255,0.75);
  backdrop-filter: blur(15px);
  border-radius: 20px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.08);
}
.header {
  background: linear-gradient(135deg,var(--primary),#6366f1);
  color: #fff;
  border-radius: 20px;
  padding: 20px;
}
.btn-primary {
  background: linear-gradient(135deg,var(--primary),#6366f1);
  border: none;
  border-radius: 14px;
  font-weight: 600;
}
.btn-success {
  background: linear-gradient(135deg,#16a34a,#22c55e);
  border: none;
  border-radius: 14px;
  font-weight: 600;
}
.btn-dark { border-radius: 14px; }
.summary-card {
  border-radius: 18px;
  padding: 15px;
  background: #fff;
  box-shadow: 0 10px 25px rgba(0,0,0,0.06);
}
.summary-card span {
  font-size: 20px;
  font-weight: 700;
}
.paid-row { background: #ecfdf5!important; }
.remaining-row { background: #fff; }
canvas { max-height: 300px; }
.swiper-pagination-bullet-active { background: var(--primary); }
</style>
</head>

<body>

<div class="container my-4">

<!-- HEADER -->
<div class="header text-center mb-4 glass">
  <h2 class="fw-bold mb-1">ğŸ  Home Loan Tracker</h2>
  <p class="mb-0 opacity-75">Smart EMI insights â€¢ Bank-accurate</p>
</div>

<!-- INPUT -->
<div class="glass p-4 mb-4 border border-success">
  <div class="row g-3">
    <div class="col-md-3">
      <label>First EMI Date(àªªàª¹à«‡àª²à«‹ àª¹àªªà«àª¤àª¾ àª¨à«€ àª¤àª¾àª°à«€àª–)</label>
      <input type="date" id="firstEmiDate" class="form-control">
    </div>
    <div class="col-md-2">
      <label>Tenure (Years)(àªµàª°à«àª·)</label>
      <input type="number" id="tenure" class="form-control">
    </div>
    <div class="col-md-3">
      <label>Loan Amount (â‚¹)(àª•à«‡àªŸàª²à«€ àª²à«‹àª¨ àª›à«‡)</label>
      <input type="number" id="loanAmount" class="form-control">
    </div>
    <div class="col-md-2">
      <label>Interest %(àª•à«‡àªŸàª²àª¾ àªŸàª•àª¾ àªµà«àª¯àªœ)</label>
      <input type="number" step="0.01" id="interest" class="form-control">
    </div>
    <div class="col-md-2 d-grid">
      <label>&nbsp;</label>
      <button id="calculate" class="btn btn-primary">Calculate</button>
    </div>
  </div>
</div>

<!-- RESULT -->
<div id="result" style="display:none">

<!-- SUMMARY -->
<div class="row text-center mb-3">
  <div class="col-md-3 col-6">
    <div class="summary-card border border-success">
      <small>Total Paid</small><br>â‚¹ <span id="totalPaid"></span>
    </div>
  </div>
  <div class="col-md-3 col-6">
    <div class="summary-card border border-success">
      <small>Remaining</small><br>â‚¹ <span id="remainingLoan"></span>
    </div>
  </div>
  <div class="col-md-3 col-6 mt-2 mt-md-0">
    <div class="summary-card border border-success">
      <small>Monthly EMI</small><br>â‚¹ <span id="emiAmount"></span>
    </div>
  </div>
  <div class="col-md-3 col-6 mt-2 mt-md-0">
    <div class="summary-card border border-success">
      <small>Total Payable</small><br>â‚¹ <span id="totalPayable"></span>
    </div>
  </div>
</div>

<!-- OPTIONAL PREPAYMENT -->
<div class="glass p-3 mb-3 border border-success">
  <h6 class="fw-semibold mb-2">ğŸ§® Optional Prepayment</h6>
  <div class="row g-2 align-items-end">
    <div class="col-md-4">
      <input type="number" id="prepayAmount" class="form-control" placeholder="Enter prepayment amount â‚¹">
    </div>
    <div class="col-md-2 d-grid">
      <button class="btn btn-success" id="applyPrepay">Apply</button>
    </div>
    <div class="col-md-6">
      <small>
        New Balance: â‚¹ <b id="newBalance">0</b> |
        Interest Saved: â‚¹ <b id="interestSaved">0</b>
      </small>
    </div>
  </div>
</div>

<!-- TABLE -->
<div class="glass p-3 mb-4 border border-success  ">
  <div class="table-responsive ">
    <table class="table table-bordered table-sm">
      <thead>
        <tr>
          <th>EMI Date</th>
          <th>Principal</th>
          <th>Interest</th>
          <th>EMI</th>
          <th>Balance</th>
        </tr>
      </thead>
      <tbody id="emiTable"></tbody>
    </table>
  </div>
</div>

<!-- SWIPEABLE CHARTS -->
<div class="glass p-3 border border-success  " id="chartSection">
  <div class="swiper">
    <div class="swiper-wrapper">
      <div class="swiper-slide"><canvas id="emiChart"></canvas></div>
      <div class="swiper-slide"><canvas id="donutChart"></canvas></div>
      <div class="swiper-slide"><canvas id="prepayChart"></canvas></div>
    </div>
    <div class="swiper-pagination"></div>
  </div>
</div>

</div>
</div>

<script>
let chart, donutChart, prepayChart;
let remainingGlobal = 0, totalInterestGlobal = 0;

$("#calculate").click(function(){
  let firstEmiDateVal=$("#firstEmiDate").val();
  let tenure=+$("#tenure").val();
  let loan=+$("#loanAmount").val();
  let interest=+$("#interest").val();
  if(!firstEmiDateVal||!tenure||!loan||!interest){alert("Fill all fields");return;}

  let firstEmiDate=new Date(firstEmiDateVal);
  let months=tenure*12;
  let rate=interest/12/100;
  let emi=Math.round(loan*rate*Math.pow(1+rate,months)/(Math.pow(1+rate,months)-1));
  let totalPayable=emi*months;

  let balance=loan,totalPaid=0;
  let labels=[],p=[],i=[],b=[];
  let today=new Date();
  totalInterestGlobal=0;

  $("#emiTable").html("");

  for(let x=0;x<months;x++){
    let emiDate=new Date(firstEmiDate);
    emiDate.setMonth(firstEmiDate.getMonth()+x);

    let interestPart=Math.round(balance*rate);
    let principalPart=emi-interestPart;
    balance-=principalPart;if(balance<0)balance=0;
    totalInterestGlobal+=interestPart;

    if(emiDate<=today){totalPaid+=emi;remainingGlobal=balance;}

    labels.push(emiDate.toLocaleDateString("en-IN"));
    p.push(principalPart); i.push(interestPart); b.push(balance);

    $("#emiTable").append(`
      <tr class="${emiDate<=today?'paid-row':'remaining-row'}">
        <td>${emiDate.toLocaleDateString("en-IN")}</td>
        <td>${principalPart.toLocaleString()}</td>
        <td>${interestPart.toLocaleString()}</td>
        <td>${emi.toLocaleString()}</td>
        <td>${Math.round(balance).toLocaleString()}</td>
      </tr>
    `);
  }

  $("#emiAmount").text(emi.toLocaleString());
  $("#totalPaid").text(totalPaid.toLocaleString());
  $("#remainingLoan").text(Math.round(remainingGlobal).toLocaleString());
  $("#totalPayable").text(totalPayable.toLocaleString());
  $("#result").fadeIn();

  renderCharts(labels,p,i,b,loan);
});

function renderCharts(l,p,i,b,loan){
  if(chart)chart.destroy();
  chart=new Chart(document.getElementById("emiChart"),{
    type:"line",
    data:{labels:l,datasets:[
      {label:"Principal",data:p,fill:true},
      {label:"Interest",data:i,fill:true},
      {label:"Balance",data:b,fill:true}
    ]},
    options:{animation:{duration:1200}}
  });

  if(donutChart)donutChart.destroy();
  donutChart=new Chart(document.getElementById("donutChart"),{
    type:"doughnut",
    data:{labels:["Principal","Interest"],
    datasets:[{data:[loan,totalInterestGlobal]}]},
    options:{animation:{animateRotate:true}}
  });

  new Swiper('.swiper',{pagination:{el:'.swiper-pagination'},spaceBetween:20});
}

$("#applyPrepay").click(function(){
  let prepay=+$("#prepayAmount").val();
  if(!prepay||prepay<=0)return;

  let newBal=remainingGlobal-prepay;if(newBal<0)newBal=0;
  let saved=totalInterestGlobal*(prepay/(remainingGlobal+prepay));

  $("#newBalance").text(Math.round(newBal).toLocaleString());
  $("#interestSaved").text(Math.round(saved).toLocaleString());

  if(prepayChart)prepayChart.destroy();
  prepayChart=new Chart(document.getElementById("prepayChart"),{
    type:"bar",
    data:{labels:["Before","After"],
    datasets:[{label:"Outstanding Balance",data:[remainingGlobal,newBal]}]},
    options:{animation:{duration:1000}}
  });
});
</script>

</body>
</html>
